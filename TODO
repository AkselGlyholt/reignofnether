


TODO bugs/features:

Save unit owners and buildings to the world to prevent loss of data on server shutdown
    - Units: saved on every unit spawn including conversions
    - RTSPlayers: saved on startRTS actions or defeats
    - Resources: unit resources AND current resources both saved on server shutdown
    - NetherZones: saved on creation, flip, deletion and server shutdown

    - Research: saved on addition and server shutdown
    - Tutorial


test server stop conditions:
    - closing the server window/ending the process
    - regular shutdown
    - crash via unrelated exception (triggered by secret key combo?)
    - [Singleplayer] exit and reenter world
    - [Singleplayer] exit and close game then reenter world
    - [Singleplayer] close window and reenter world
    - [Singleplayer] crash via unrelated exception

    - test that upgraded buildings retain their upgrade status (flag castle, lab rod, portal upgrades)
    - check no duplicates exist

bugs:
    - player is defeated on server close if they only had units
        - maybe just accept it since this means its only the start of the game anyway?

    - need to add isBuilt flag and portal type


QoL/Balance
-----------
allow selecting a building if the block ABOVE a preselected building is part of the building
    - this handles being able to select hollow foundations easily like town centres
villagers get stuck in the bridge if they fall in water
    - apply some upwards velocity?

To test:
-------
general tutorial completion





[FOG OF WAR] playtest checklist:
--------------------------------
- buildings destroyed offscreen are updated correctly
- buildings placed offscreen are updated correctly
- destroyed buildings no longer have frozenchunks
- explored frozenchunks should not have any unsynced blocks
- night-warping buildings that are destroyed serverside but unexplored clientside should have their night-warping abilities disabled





Misc additions
-----------------
- change witches to auto attack like evokers, reduce cooldown, reduce potion strength and remove lingering effect
    - ability to toggle between potion types
    - ability to toggle between auto-attack targets (ally or enemy)

- add a tier of farm upgrades to each faction
    - pumpkins -> carved pumpkins
    - wheat -> potatoes
    - red nylium netherwart -> green nylium

- give units smooth block climbing for 1-block-high ledges (horse/ravager move logic)
- recalculate unit pathing as soon as they are damaged, or else melee units attacking each other run past each other a lot
    - most prevalent in 1v1 melee combat

Let workers gather beehives




New Upgrades
------------
MONSTERS: Upgrade for watchtowers to come with a shulker in the centre
PIGLINS: Upgrade for ghasts to spread nether on hit (solves issue of spreading base over water)
VILLAGERS: New potions for witches

New Units
---------
MONSTERS: Endermen who can't attack but have a cooldown ability to place shulker boxes (with limited lifespan) (research extends lifespan)
    - comes from ender portal building
PIGLINS: Magma cubes (research make melee attacks set enemies on fire)
    - comes from mother cube building - giant building that looks exactly like a magma cube
VILLAGERS: Illusioner - hallucination ability, targeted invisibility (research unlocks second ability)
    - comes from new supplementary building ala-library



Bugs backlog
------------
- time set causes desyncs when done with /gamerule dodaynightcycle false
- workers are not marked as idle until 15s after stopping gathering
- turning on fog of war causes a crash when optifine is installed
- portal blocks crack when explored (because of updating fake frozen blocks)
- minimap still shows physical blocks in fog until the camera moves (and replaces them with fake frozen blocks)
    - because the frozenchunk logic in MinimapClientEvents can save air

(MacOS) minecraft title screen is messed up and doesn't retrieve the assets
(MacOS) GUI scaling does not work
(MacOS) macbooks dont have alt and ctrl (it's option and command)

TODO vanilla player balancing/interaction (backlog)
- Balance strong player actions using food:
    - sprinting (very high)
    - attacking (medium)
    - gathering (low)
    - walking and jumping (low)
- Attacking any melee unit that's targeting a player should immediately deal its melee damage to them
- Punching disabled, combat and resource gathering can only be done if the player has tools/weapons
- Turned into a ghost on death - must walk back to a capitol building to be resurrected for a resource cost
- Tools/weapons provided by the RTS player using resources
- Items/utilities for non-RTS players should be produced at existing buildings:
    - Villagers
        - Stockpile - Wooden axe/pickaxe/shovel/hoe
        - Barracks - Weapons
        - Blacksmith - Armour
        - Arcane Tower - Potions
        - Library - Enchanting table
    - Monsters
        - Stockpile - Wooden axe/pickaxe/shovel/hoe
        - Laboratory - Armour + Potions
        - Dungeon - Weapons (via chests)
        - Mausoleum - Enchanting table (after upgrade)
    - Piglins
        - Military portal - Weapons + armor
        - Civilian Portal - Wooden axe/pickaxe/shovel/hoe
        - Flame Sanctuary - potions
        - Wither shrine - Enchanting table